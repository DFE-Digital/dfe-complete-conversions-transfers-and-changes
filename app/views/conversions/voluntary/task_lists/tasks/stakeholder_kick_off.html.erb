<%= render(TaskList::TaskHeaderComponent.new(project: @project, task: @task)) %>

<% content_for :pre_content_nav do %>
  <% render partial: "shared/back_link", locals: {href: task_list_path(@project)} %>
<% end %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <%= form_for @task, url: conversions_voluntary_project_update_task_path(@project, @task.class.identifier), method: :put do |form| %>
      <%= form.govuk_error_summary %>

      <div class="govuk-form-group">
        <%= render(TaskList::CheckBoxActionComponent.new(task: @task, attribute: :introductory_emails)) %>
        <%= render(TaskList::CheckBoxActionComponent.new(task: @task, attribute: :local_authority_proforma)) %>
        <div class="govuk-checkboxes__item">
          <%= hidden_field_tag("conversion_voluntary_tasks_stakeholder_kick_off[check_provisional_conversion_date]", "0", {id: nil}) %>
          <%= check_box_tag("conversion_voluntary_tasks_stakeholder_kick_off[check_provisional_conversion_date]", 1, @task.check_provisional_conversion_date, {class: "govuk-checkboxes__input"}) %>
          <%= label_tag("conversion_voluntary_tasks_stakeholder_kick_off[check_provisional_conversion_date]", t("conversion.voluntary.tasks.stakeholder_kick_off.check_provisional_conversion_date.title", date: @project.conversion_date.strftime("01 %B %Y")), {class: "govuk-label govuk-checkboxes__label"}) %>
          <div class="hint">
            <%= t("conversion.voluntary.tasks.stakeholder_kick_off.check_provisional_conversion_date.hint.html") %>
          </div>
          <div class="guidance">
              <%= govuk_details(summary_text: t("conversion.voluntary.tasks.stakeholder_kick_off.check_provisional_conversion_date.guidance_link")) do %>
                <%= t("conversion.voluntary.tasks.stakeholder_kick_off.check_provisional_conversion_date.guidance.html") %>
              <% end %>
            </div>
        </div>

        <%= render(TaskList::CheckBoxActionComponent.new(task: @task, attribute: :setup_meeting)) %>
        <%= render(TaskList::CheckBoxActionComponent.new(task: @task, attribute: :meeting)) %>

        <% if @project.conversion_date_provisional? %>
          <%= form.govuk_date_field :confirmed_conversion_date,
                omit_day: true,
                form_group: {classes: "app-confirmed-conversion-date"},
                legend: {text: t("conversion.voluntary.tasks.stakeholder_kick_off.confirmed_conversion_date.title"), size: "s"} do %>
            <div class="govuk-hint"><%= t("conversion.voluntary.tasks.stakeholder_kick_off.confirmed_conversion_date.hint.html") %></div>

          <% end %>
        <% end %>
      </div>

      <%= form.govuk_submit t("task_list.continue_button.text") %>
    <% end %>
  </div>

  <div class="govuk-grid-column-one-third">
    <%= render partial: "conversions/shared/task_notes" %>
  </div>
</div>
